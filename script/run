#!/bin/sh
set -e

# Remove files generated by protoc to have a clean state
rm kaja-twirp.json error.txt || true
protoc --proto_path=./proto --plugin=protoc-gen-kaja-twirp=/app/protoc-gen-kaja-twirp --kaja-twirp_out=. -Iproto/ $(find proto -iname "*.proto") 2> error.txt || true

/app/kaja-twirp